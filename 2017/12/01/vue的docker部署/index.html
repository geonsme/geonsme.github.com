<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>用Docker实现Vue前端持续集成开发（上） | Geons-程序员</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">用Docker实现Vue前端持续集成开发（上）</h1><a id="logo" href="/.">Geons-程序员</a><p class="description">满陇桂雨</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">用Docker实现Vue前端持续集成开发（上）</h1><div class="post-meta">Dec 1, 2017<span> | </span><span class="category"><a href="/categories/前端/">前端</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#持续集成"><span class="toc-number">1.</span> <span class="toc-text">持续集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流程"><span class="toc-number">2.</span> <span class="toc-text">流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化Vue项目"><span class="toc-number">3.</span> <span class="toc-text">初始化Vue项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用vue-cli初始化项目"><span class="toc-number">3.1.</span> <span class="toc-text">使用vue-cli初始化项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在项目的根目录下编写Dockerfile"><span class="toc-number">3.2.</span> <span class="toc-text">在项目的根目录下编写Dockerfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#推送到github上"><span class="toc-number">3.3.</span> <span class="toc-text">推送到github上</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用DaoCloud搭建Devops流程"><span class="toc-number">4.</span> <span class="toc-text">使用DaoCloud搭建Devops流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#注册一个DaoCloud并授权Github仓库"><span class="toc-number">4.1.</span> <span class="toc-text">注册一个DaoCloud并授权Github仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在Devops中新建一个项目"><span class="toc-number">4.2.</span> <span class="toc-text">在Devops中新建一个项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建镜像版本，准备好创建一个应用"><span class="toc-number">4.3.</span> <span class="toc-text">构建镜像版本，准备好创建一个应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#部署到云端测试环境或者自己主机中"><span class="toc-number">4.4.</span> <span class="toc-text">部署到云端测试环境或者自己主机中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建第一个应用！"><span class="toc-number">4.5.</span> <span class="toc-text">创建第一个应用！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#外网访问我们的Vue应用！"><span class="toc-number">4.6.</span> <span class="toc-text">外网访问我们的Vue应用！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义构建和发布"><span class="toc-number">5.</span> <span class="toc-text">自定义构建和发布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">6.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="post-content"><h2 id="持续集成"><a href="#持续集成" class="headerlink" title="持续集成"></a>持续集成</h2><p>传统讲来，持续集成无非就是将业务随着提交不断地进行构建、集成并部署到测试环境或生产环境，过去都是用脚本代替人工进行构建，在回滚和事务隔离上是致命弱点。因此，有了基于Docker的持续集成概念，本文以现学现卖的VUE例子，抛弃传统的部署方式，用容器技术快速打造一个开发部署环境，最引人注目的是在传统的事务回滚上加上了环境回滚，将版控提升了一层，个人觉得很好用。</p>
<h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><ul>
<li>代码在本地编写后提交到Github</li>
<li>触发分支构建</li>
<li>自动部署到服务器上</li>
<li>版本可视化管理，支持环境回滚</li>
</ul>
<h2 id="初始化Vue项目"><a href="#初始化Vue项目" class="headerlink" title="初始化Vue项目"></a>初始化Vue项目</h2><h3 id="使用vue-cli初始化项目"><a href="#使用vue-cli初始化项目" class="headerlink" title="使用vue-cli初始化项目"></a>使用vue-cli初始化项目</h3><p>Vue-cli脚手架的具体用法请移步<a href="http://geons.me/fast-study-vue.html">Vue脚手架-手摸手系列</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack vue-docker-demo</span><br></pre></td></tr></table></figure>
<h3 id="在项目的根目录下编写Dockerfile"><a href="#在项目的根目录下编写Dockerfile" class="headerlink" title="在项目的根目录下编写Dockerfile"></a>在项目的根目录下编写Dockerfile</h3><p><img src="http://oyc3sy7c4.bkt.clouddn.com/vue-docker-dockerfile.png" alt="dockerfile文件"><br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用Node精简版作为基础镜像</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">6.10</span>.<span class="number">3</span>-slim</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装nginx</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update \    </span></span><br><span class="line">    &amp;&amp; apt-get install -y nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定工作目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前目录拷贝到工作目录下</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明运行时容器提供服务端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line"><span class="comment"># build</span></span><br><span class="line"><span class="comment"># 拷贝到ng目录下</span></span><br><span class="line"><span class="comment"># 删除目录文件</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  npm install \</span></span><br><span class="line"><span class="bash">     &amp;&amp; npm run build \     </span></span><br><span class="line">     &amp;&amp; cp -r dist/* /var/www/html \     </span><br><span class="line">     &amp;&amp; rm -rf /app</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以前台形式启动ng</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"nginx"</span>,<span class="string">"-g"</span>,<span class="string">"daemon off;"</span>]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="推送到github上"><a href="#推送到github上" class="headerlink" title="推送到github上"></a>推送到github上</h3><blockquote>
<p>单独建立一个仓库，这样便于维护和部署<br>至此，我们的开发代码已经成功版本控制了，接下来是使用Devops流程</p>
</blockquote>
<h2 id="使用DaoCloud搭建Devops流程"><a href="#使用DaoCloud搭建Devops流程" class="headerlink" title="使用DaoCloud搭建Devops流程"></a>使用DaoCloud搭建Devops流程</h2><blockquote>
<p>这里只是举例使用DaoCloud，其他公有云平台也可以做到的，只是这个对个人独立开发者比较OK</p>
</blockquote>
<h3 id="注册一个DaoCloud并授权Github仓库"><a href="#注册一个DaoCloud并授权Github仓库" class="headerlink" title="注册一个DaoCloud并授权Github仓库"></a>注册一个DaoCloud并授权Github仓库</h3><ul>
<li>用户中心</li>
<li>代码托管</li>
<li>授权访问Github仓库<blockquote>
<p>注册流程就不详细说了，关键一点是授权Github仓库，也就是你源码管理的仓库，这样就可以直接关联到你的GitHub。本人在授权过程中，忽略了一个问题，因为github之前授权给了很老的一个号，是不能同时授权的，所以幸好找回了老号码接触了绑定，希望大家不要犯这样的低级错误。</p>
</blockquote>
</li>
</ul>
<h3 id="在Devops中新建一个项目"><a href="#在Devops中新建一个项目" class="headerlink" title="在Devops中新建一个项目"></a>在Devops中新建一个项目</h3><p>新建后选择对应的github项目，也就是vue-docker-demo所在的仓库。</p>
<h3 id="构建镜像版本，准备好创建一个应用"><a href="#构建镜像版本，准备好创建一个应用" class="headerlink" title="构建镜像版本，准备好创建一个应用"></a>构建镜像版本，准备好创建一个应用</h3><ul>
<li>选择“手动触发”</li>
<li><p>触发方式选择master分支<br><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf12d8a14e5ea?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="创建镜像"></p>
</li>
<li><p>镜像构建成功后可在镜像仓库中查看<br><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf152e156f10d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="镜像"></p>
</li>
</ul>
<h3 id="部署到云端测试环境或者自己主机中"><a href="#部署到云端测试环境或者自己主机中" class="headerlink" title="部署到云端测试环境或者自己主机中"></a>部署到云端测试环境或者自己主机中</h3><p>Daocloud提供了胶囊主机，可以做临时的开发测试使用，如果是正式开发环境建议购买主机，将主机接入集群中，进行统一管理。<br>官网提供了很完善的自有主机接入教程，这里不再详细展开<br><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf0e8b7f97804?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="主机"><br>接入主机后，可以在面板看到集群中已经有1台主机正常运行。<br><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf1d36fd5a210?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="主机"></p>
<h3 id="创建第一个应用！"><a href="#创建第一个应用！" class="headerlink" title="创建第一个应用！"></a>创建第一个应用！</h3><blockquote>
<p>进入镜像仓库，选择刚刚构建出来的镜像进行部署，应用和镜像的关系可以查看Docker官方文档区分。</p>
</blockquote>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf1c416ab9539?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt><br><img src="https://user-gold-cdn.xitu.io/2017/11/21/15fdf1f270b7eb89?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt></p>
<blockquote>
<p>接下来的时间就是静候镜拉取，容器启动</p>
</blockquote>
<h3 id="外网访问我们的Vue应用！"><a href="#外网访问我们的Vue应用！" class="headerlink" title="外网访问我们的Vue应用！"></a>外网访问我们的Vue应用！</h3><p>可以看到刚刚部署的应用已经成功了！<br>点击容器卡的端口，选择外网访问的入口，即可外网访问到应用<br><img src="http://oyc3sy7c4.bkt.clouddn.com/vue-docker-daocloud.png" alt></p>
<blockquote>
<p>这里不仅可以很直观查看应用的状况，还能够对整个容器进行监控，还有云隧道、迁移、发布等选项，很方便的完成负责的环境部署等等。</p>
</blockquote>
<h2 id="自定义构建和发布"><a href="#自定义构建和发布" class="headerlink" title="自定义构建和发布"></a>自定义构建和发布</h2><p>请移步<a href>用Docker实现Vue前端持续集成开发（下）</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>从整个流程来看，我们没有关心任何生产环境的配置等等，专注的编写好vue业务，然后就让外网用户访问到了，只花了半小时时间，足见docker进行开发部署的方便，当然，这是一个单点应用Demo，没有涉及到负责的nginx配置，负载均衡，日志Col，灰度发布等，在后面的文章中会介绍docker更多的用处。</p>
</div><div class="tags"><a href="/tags/vue/">vue</a></div><div class="post-nav"><a class="pre" href="/2017/12/08/linux更新内核/">Debian或者Ubuntu内核更新教程</a><a class="next" href="/2017/11/25/windows安装redis/">Redis Windows64位安装</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台/">后台</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/后端/">后端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/想法/">想法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统/">系统</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/ab压测/" style="font-size: 15px;">ab压测</a> <a href="/tags/自动化/" style="font-size: 15px;">自动化</a> <a href="/tags/测试技术/" style="font-size: 15px;">测试技术</a> <a href="/tags/网络编程/" style="font-size: 15px;">网络编程</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/奇怪的想法/" style="font-size: 15px;">奇怪的想法</a> <a href="/tags/会玩/" style="font-size: 15px;">会玩</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/持续集成/" style="font-size: 15px;">持续集成</a> <a href="/tags/弱网测试/" style="font-size: 15px;">弱网测试</a> <a href="/tags/树莓派/" style="font-size: 15px;">树莓派</a> <a href="/tags/源码/" style="font-size: 15px;">源码</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a> <a href="/tags/weex/" style="font-size: 15px;">weex</a> <a href="/tags/webapp/" style="font-size: 15px;">webapp</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/05/09/fishfind/">做个水下探测器-fishfind</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/24/atc弱网环境/">ATC弱网测试环境搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/14/supervisor进程监管/">supervisor实现Django进程监管</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/14/python3.7编译/">Python3.7生产环境谨慎安装指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/27/weex-tor/">weex入门踩坑指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/08/uwsgi-nginx-timout/">一个奇怪的连接断开bug</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/08/uwsgi-django-nginx/">nginx+uwsgi在生产环境中部署Django</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/06/ab-tools/">ab——一个超简单的压测工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/04/bottle-tech/">Bottle—快速实现小型服务接口</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/24/python内存管理/">Python垃圾回收机制</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.keakon.net/category/Python" title="分类Python" target="_blank">分类Python</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">Geons-程序员.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>